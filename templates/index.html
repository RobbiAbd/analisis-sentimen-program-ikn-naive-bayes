<!DOCTYPE html>
<html>
  <head>
    <title>Analisis Sentimen TikTok</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container my-4 mx-4">
      <div class="card">
        <h5 class="card-title">Analisis Sentimen TikTok</h5>
        <div class="card-body text-center">
          <h3>Prediksi Komentar</h3>
          <input
            type="text"
            id="komentar"
            class="form-control"
            placeholder="Tulis komentar..."
          />
          <button class="btn btn-sm btn-success my-4" onclick="predict()">
            Prediksi
          </button>

          <p id="hasil"></p>

          <h3>Distribusi Sentimen</h3>
          <canvas id="sentimentChart" width="50" height="50"></canvas>
        </div>
      </div>
    </div>

    <script>
      function predict() {
        const komentar = document.getElementById("komentar").value;
        fetch("/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ komentar: komentar }),
        })
          .then((response) => response.json())
          .then((data) => {
            document.getElementById("hasil").innerText =
              "Sentimen: " + data.sentimen;
          });
      }

      fetch("/data")
        .then((response) => response.json())
        .then((data) => {
          const ctx = document
            .getElementById("sentimentChart")
            .getContext("2d");
          new Chart(ctx, {
            type: "pie",
            data: {
              labels: Object.keys(data),
              datasets: [
                {
                  label: "Jumlah Komentar",
                  data: Object.values(data),
                  backgroundColor: ["#36A2EB", "#FF6384", "#FFCE56"],
                },
              ],
            },
          });
        });
    </script>
  </body>
</html>
